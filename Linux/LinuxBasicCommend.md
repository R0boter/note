

## shell操作

1. 读取历史命令

   |    命令     |                    作用                     |
   | :---------: | :-----------------------------------------: |
   |   history   |              显示已输入的命令               |
   | history num |         显示最后num条已输入的命令。         |
   |   !number   | number为history后显示的命令编号，执行该命令 |
   |    !str     |      执行最近一条以指定的str开头的命令      |

## 帮助

1. `man command`：manual的缩写，用于查询command的详细帮助手册

   |      命令       |         作用          |
   | :-------------: | :-------------------: |
   | man -k command  |       模糊匹配        |
   | man -f command  |       精确匹配        |
   | man num command | 查询指定章节的command |

   > 返回的结果包含：command (num)    simple explanation
   >
   > Tips:num是指该返回的command在man手册的第几章

2. `info command`：用于查询命令的信息，不太常用

3. `command -h`：用于查询command的常用选项

4. `command --help`：对有的command无法使用`-h`时，则使用`--help`来查询command的常用选项

## 语言环境

`locale`：显示当前默认的语言环境

`locale -a`：显示系统支持的所有语言环境

## 日期

1. `date`：显示当前的日期和时间

   日期的格式化查询:

   | 命令  |     含义      |
   | :---: | :-----------: |
   |  %Y   |     year      |
   |  %m   |     month     |
   |  %d   | day of month  |
   |  %H   |  hour(00-23)  |
   |  %I   |  hour(01-12)  |
   |  %M   | minute(00-59) |
   |  %S   | second(00-60) |

   > Tips：日期和时间中用空格隔开，可以在各选项中使用自定义的连接符，例如：`date %Y_%m_%d %H:%M:%S``
   >
   > ``date -s`：设置当前的日期和时间，需root权限。
   >
   > 设置日期：`date -s 20190101`设置日期时会将时间重置为00:00:00
   >
   > 设置时间：`date -s 23:12:59`设置时间不会对日期造成更改
   >
   > 同时设置：`date -s “23:12:59 2019-01-01”`
   >
   > Tips：如果想将设置好的时间同步到主板可以使用`hwclock -w`

2. `cal`：显示当月的日历

   `cal -y`：默认显示当年的日历

   `cal year_number`：显示指定年的日历

3. `tzselect`：设置TimeZone。

   或者使用`cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime`

## 注销、重启、关机

`logout`：当在字符界面时，使用此命令注销当前用户

`reboot`：重启系统，需管理员权限

`shutdown`：关机，需管理员权限。后跟`-r`为重启命令，`-h`为关机命令

> shutdown -r|-h now    立即重启或关机
>
> shutdown -r|-h +5    5分钟后重启或关机
>
> shutdown -r|-h xx:xx:xx    指定时间重启或关机
>
> shutdown -c        取消操作

## 用户和组操作

1. 添加用户

   `useradd`：

   > -c 添加备注。即添加/etc/passwd第五字段的内容
   >
   > -d 指定用户家目录。即用户登录后默认进入的目录，并赋予用户对该目录的完全控制权
   >
   > -e 指定账户的过期时间。格式为`YYYY-MM-DD`，保存在/etc/shadow中第八字段
   >
   > -f 指定账户密码过期后的缓冲天数。即密码过期后账户还可以使用的天数
   >
   > -g 指定账户所属的主要组。只能指定一个
   >
   > -G 指定账户所属的次要组。可指定多个
   >
   > -M 强制不创建用户家目录
   >
   > -m 强制创建用户家目录，并将/etc/skel/下的文件复制到用户家目录
   >
   > -p 创建用户的密码。如果不创建，则必须在添加用户后，用`passwd`修改用户密码
   >
   > -s 指定用户登陆使用的shell。即/etc/passwd中的第七字段
   >
   > -u 指定用户的UID。即账户标识符，在/etc/passwd中的第三字段

2. 删除用户

   |         命令         |                        作用                        |
   | :------------------: | :------------------------------------------------: |
   |  userdel user_name   |              删除用户，但保留用户文件              |
   | userdel -r user_name | 删除用户，并删除用户家目录和邮箱，但其他文件需手动 |
   | userdel -f user_name | 强制删除用户和用户家目录与邮箱，即使用户在登录状态 |

3. 修改用户信息

   `usermod`

   > -c 修改账户备注信息
   >
   > -d 修改账户家目录
   >
   > -e 修改账户的过期日期
   >
   > -f 修改账户密码过期后的缓冲天数
   >
   > -g 修改账户所属的主要组
   >
   > -G 修改账户所属的次要组
   >
   > -l 修改账户名称
   >
   > -L 锁定账户，使密码无效。任何人不能用此账户登录
   >
   > -U 解除锁定
   >
   > -s 修改账户登录后的shell
   >
   > -u 修改账户的UID
   >
   > -a 指定要操作的用户名

4. 修改用户密码

   |      命令       |              作用              |
   | :-------------: | :----------------------------: |
   |     passwd      |       修改当前用户的密码       |
   | passwd username | 修改指定用户的密码，需root权限 |

5. 添加和删除组

   |        命令         |       作用        |
   | :-----------------: | :---------------: |
   | groupadd group_name |      添加组       |
   |     groupadd -g     | 添加组，并指定GID |
   | groupdel group_name |      删除组       |

6. 切换用户

   |          命令           |                       作用                       |
   | :---------------------: | :----------------------------------------------: |
   |         su user         |                 切换为指定的用户                 |
   |        su - user        |     切换为指定的用户，并加载该用户的环境配置     |
   |      sudo command       |      让当前用户暂时以root身份运行指定的命令      |
   | pkexec [--user] command | 允许授权用户以另一个用户运行指定命令，默认为root |

   > 要使sudo能让当前用户以root用户运行命令，需配置sudo的配置文件`/etc/sudoers`
   >
   > **当sudo无法使用时，可以使用pkexec命令不指定用户，则会默认以root身份运行指定command**

## 目录和文件操作

1. 切换目录

   |  命令  |         作用         |
   | :----: | :------------------: |
   |   cd   | 切换到当前用户家目录 |
   | cd dir |    切换到指定目录    |
   | cd ..  | 返回当前目录的父目录 |
   |  cd -  |   返回到之前的目录   |

2. 创建目录

   |            命令             |          作用          |
   | :-------------------------: | :--------------------: |
   | mkdir path/directories_name | 创建目录，可以指定路径 |
   |    mkdir -p dir/dir/dir     |    递归创建多级目录    |

3. 修改文件时间戳和创建文件

   |         命令         |                     作用                     |
   | :------------------: | :------------------------------------------: |
   |   touch file_name    |   更新文件时间戳，如果文件不存在则创建文件   |
   |  touch -c file_name  | 更新文件时间戳，如果文件不存在时不会创建文件 |
   | touch -r file1 file2 |        更新file2的时间戳，和file1相同        |
   |  touch -t time file  |        将file的时间戳更新为指定的时间        |

   > Tips：time的格式为[[CC]YY]MMDDhhmm.ss
   >
   > CCYY：CC为世纪数，即年份的前两位。YY为世纪数中的年数。如果不给定值则touch默认创建在1969-2068之内的年数
   >
   > MMDD：日期数
   >
   > hhmm.ss：时间数。其中ss的设定范围为0-61，这样可以处理闰秒
   >
   > 这些数字组成的时间是环境变量TZ指定的时区中的时间，由于系统限制早于1970/1/1的时间是错误的

4. 删除

   | 命令  |                作用                |
   | :---: | :--------------------------------: |
   | rm -i |        删除文件时需用户确认        |
   | rm -f |              强制删除              |
   | rm -r |     删除指定目录及其下所有文件     |
   | rmdir | 删除一个指定的空目录，目录必须为空 |

   > Tips：可一次指定多个选项

5. 移动或重命名

   |        命令         |             作用             |
   | :-----------------: | :--------------------------: |
   |   mv source dest    | 重命名操作，也可以对目录操作 |
   |    mv file dir/     |   将指定文件移动到指定目录   |
   | mv file1 file2 dir/ |  移动多个指定文件到指定目录  |

6. 复制

   |       命令        |                   作用                   |
   | :---------------: | :--------------------------------------: |
   | cp -i source dest |           如果遇到需覆盖则提示           |
   |  cp -r dir1 dir2  |   复制一个目录，包括其下的子目录和文件   |
   | cp -p source dest | 复制包括文件的权限和修改时间。需root权限 |

7. 权限设置

   |    命令     |              作用              |
   | :---------: | :----------------------------: |
   | chmod a=rwx | 给所有人都赋予读、写、执行权限 |
   |  chmod u+r  |        给user赋予写权限        |
   |  chmod g-w  |       去掉gourp的写权限        |
   | chmod o=rx  |    给other赋予读和执行权限     |

   > 还可以用数字给文件赋予不同权限，例：chmod 755 file
   >
   > 关于文件权限在Linux基础笔记中的文件一节有介绍

8. 更改文件所有者和所有组

   |         命令          |           作用           |
   | :-------------------: | :----------------------: |
   | chown user:gourp file | 更改文件的所有者和所有组 |
   |    chown user file    |    只更改文件的所有者    |
   |   chown :gourp file   |    只更改文件的所有组    |

## 文件内容操作

1. `ls`：查看当前目录下的文件

   |  命令  |                     作用                     |
   | :----: | :------------------------------------------: |
   | ls dir |             查看指定路径下的文件             |
   | ls -a  |    查看当前目录下的所有文件，包括隐藏文件    |
   | ls -A  |      和-a一样,但不显示当前目录和父目录       |
   | ls -l  |         查看当前目录下文件的详细信息         |
   | ls -R  | 列出当前目录下的所有文件，包括子目录中的文件 |
   | ls -r  |   以英文字母顺序的逆序显示当前目录下的文件   |
   | ls -t  |    以文件修改时间排序显示当前目录下的文件    |

   > Tips：可一次指定多个选项。关于文件信息在linux基础笔记里

2. 查看详细信息

   `stat`：比`ls -l`更加详细的显示一个文件的全部统计信息

   > Tips：关于文件的三个时间戳
   >
   > 1. Access time(atime)：是指取用文件的时间，所谓取用，常见的操作有：使用编辑器查看文件内容，使用cat命令显示文件内容，使用cp命令把该文件（即来源文件）复制成其他文件，或者在这个文件上运用grep sed more less tail head 等命令，凡是读取而不修改文件的操作，均衡改变文件的Access time.
   > 2. Modify time(mtime)：是指修改文件内容的时间，只要文件内容有改动（如使用转向输出或转向附加的方式）或存盘的操作，就会改变文件的Modify time,平常我们使用ls –l查看文件时，显示的时间就是Modify time
   > 3. Change time(ctime)：是指文件属性或文件位置改动的时间，如使用chmod，chown,mv指令集使用ln做文件的硬是连接，就会改变文件的Change time.

3. `pwd`:查看当前路径

4. 读取文件内容

   |   命令   |                         作用                         |
   | :------: | :--------------------------------------------------: |
   | cat file |       输出文件内容，可以指定多个文件用空格隔开       |
   | tac file |       反转行输出文件内容，即从最后一行反向输出       |
   |  cat -n  |               输出时显示行号，从1开始                |
   |  cat -s  | 合并多余的空行，只保留一行。但空行中存在空格时不合并 |

5. 统计文件中的字节数、字数、行数

   | 命令  |                         作用                         |
   | :---: | :--------------------------------------------------: |
   | wc -c |                      统计字节数                      |
   | wc -l |                       统计行数                       |
   | wc -m |               统计字符数，不能与-c连用               |
   | wc -w | 统计字数，一个字被定义为：由空格或换行符隔开的字符串 |

6. 排序

   |     命令      |               作用                |
   | :-----------: | :-------------------------------: |
   |   sort file   |      对文件内容进行排序输出       |
   |    sort -r    |               逆序                |
   |    sort -f    |            忽略大小写             |
   |    sort -b    |        忽略最前面的空格符         |
   |    sort -u    |            忽略重复行             |
   | sort -t “str” |    指定以str为分隔符，和-k连用    |
   |  sort -k num  | 指定以-t分隔后的第num列，进行排序 |

7. 忽略或报告重复行

   |   命令    |                   作用                    |
   | :-------: | :---------------------------------------: |
   | uniq file |      输出文件内容，重复行只输出一行       |
   |  uniq -c  | 输出文件内容，重复行只输出一行,并进行计数 |
   |  uniq -u  |        只输出唯一行，重复行不输出         |
   |  uniq -i  |                忽略大小写                 |

8. 从文本文件或文本流中提取文本列

   |         命令          |                       作用                       |
   | :-------------------: | :----------------------------------------------: |
   | cut -dstr -f num file | -d以指定的str为分隔符，-f指定读取分割后的第num列 |
   |    cut -c num file    |          读取指定的第num列，可读取多列           |

   > 例：cut 1,3 file(读取第一和第三列) cut -c 1-5 file(读取第一到第五列)

9. 读取标准输入的数据，并将其内容输出到文件

   |    命令     |                       作用                       |
   | :---------: | :----------------------------------------------: |
   |  tee file   | 读取输入并输出到文件，可指定多个文件，用空格隔开 |
   | tee -a file |             读取输入并追加到文件末尾             |

   > Tips：可以用读取命令读取文件后，再用tee输出到另一个文件。两个命令中间用`|`隔开
   >
   > 例：cat file1 | tee file2

10. 查看文件内容

    |    命令     |                     作用                      |
    | :---------: | :-------------------------------------------: |
    |    more     |                 查看文件内容                  |
    |    less     |                 查看文件内容                  |
    |    head     |         输出文件开始的部分，默认10行          |
    | head -n num |              输出文件开始的num行              |
    |    tail     | 输出文件末尾的部分，默认10行,也可用-n指定行数 |
    |   tail -f   |                 动态监控文件                  |

11. 查找命令位置

    > `which command`：返回所查找的command的路径，查找的command必须是可执行的正确的。
    >
    > 例：which ls

## 包管理器

1. Debian系：所有Debian系的Linux都默认安装了apt和dpkg包管理器

   > apt：Advanced Packaging Tool可以自动下载、安装、配置软件包
   >
   > 用法：apt-get [选项] 命令

   常用命令

   |              命令              |                    作用                    |
   | :----------------------------: | :----------------------------------------: |
   |         apt-get update         |             更新软件包列表信息             |
   |        apt-get upgrade         |            更新已安装的所有软件            |
   |      apt-get dist-upgrade      |                  更新系统                  |
   |    apt-get dselect-upgrade     |              使用dselect升级               |
   |         apt-get clean          |           删除所有已下载的包文件           |
   |       apt-get autoclean        |            删除已下载的旧包文件            |
   |         apt-get check          |            检查是否有损坏的依赖            |
   |     apt-get source package     |               下载该包源代码               |
   |   apt-get bulid-dep package    |             安装相关的编译环境             |
   |    apt-get install package     |       安装指定软件包，可一次指定多个       |
   |     apt-get remove package     |               卸载指定软件包               |
   | apt-get remove --purge package |     卸载指定软件包，并清除相关配置文件     |
   |    apt- cache search string    |    模糊搜索软件包名中包含string的软件包    |
   |     apt-cache show package     | 获取指定包的相关信息，如说明、大小、版本等 |
   |   apt-cache depends package    |                了解使用依赖                |
   |   apt-cache rdepends package   |             了解某个具体的依赖             |

   > apt配置文件：
   >
   > /etc/apt/sources.list        软件包源文件，记录软件包的获取来源
   >
   > /etc/apt/apt.conf            apt配置文件
   >
   > /etc/apt/preferences        版本参数
   >
   > /var/cache/apt/archives/partial    存放正在下载的软件包
   >
   > /var/cache/apt/archives        存放已经下载完成的软件包
   >
   > /var/lib/apt/lists/partial    存放正在下载的软件包的详细信息
   >
   > /var/lib/apt/lists        存放已经下载完成的软件包的详细信息
   >
   > dpkg：Debian Package是Debian包管理器的基础，用于安装、卸载和提供deb软件包信息。dpkg只能用于安装已下载好的deb包

   常用命令

   |           命令           |                    作用                    |
   | :----------------------: | :----------------------------------------: |
   |   dpkg -i package.deb    |                   安装包                   |
   |       dpkg -R dir        |           安装一个目录下的所有包           |
   |     dpkg -r package      |                   卸载包                   |
   |     dpkg -P package      |            卸载，并删除配置文件            |
   |     dpkg -L package      |            列出与该包关联的文件            |
   |     dpkg -l package      |               显示该包的版本               |
   |         dpkg -l          |             列出当前已安装的包             |
   |   dpkg -c package.deb    |              列出指定包的内容              |
   | dpkg -unpack package.deb |                 解开指定包                 |
   | dpkg -configure package  | 重新配置指定包，添加-a选项将重新配置所有包 |
